{{ define "main" }}
<section class="py-12 relative">

  <!-- Background behind main title -->
  <div class="absolute inset-x-0 top-0 h-36 md:h-34">
    <img src="/uploads/stacked-peaks.svg" class="w-full h-full object-cover opacity-60" />
    <div class="absolute inset-0 bg-gradient-to-b from-black/40 to-transparent"></div>
  </div>

  <div class="container mx-auto px-4 relative z-10">

    <!-- Main title -->
    {{ with .Title }}
      <h1 class="text-4xl md:text-5xl font-extrabold mb-12 text-center text-white drop-shadow-lg relative z-10">{{ . }}</h1>
    {{ end }}

    <!-- Projects grid: keep boxes here -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
      {{ range .Pages }}
        <a href="{{ .RelPermalink }}" class="block bg-white rounded-xl shadow-md hover:shadow-lg transition p-4">
          {{ with .Params.image }}
            <img src="{{ . }}" alt="{{ $.Title }}" class="w-full h-48 object-cover rounded-lg mb-4">
          {{ end }}
          <h2 class="text-2xl font-semibold text-[#18453B] mb-2">{{ .Title }}</h2>
          <p class="text-gray-700">{{ .Params.summary }}</p>
        </a>
      {{ end }}
    </div>

    <!-- Topology papers: enumerated -->
    <h2 class="text-3xl font-bold mb-6 text-[#18453B]">Topology</h2>
    <ol class="list-decimal list-inside space-y-2 mb-12">
      {{ $top := where site.RegularPages "Section" "topology" }}
      {{ range $top }}
        <li class="text-gray-800">
          {{ if .Params.citation }}
            {{ .Params.citation }}
          {{ else }}
            <strong>{{ .Title }}</strong>
            {{ with .Params.authors }}({{ range $i, $a := . }}{{ if $i }}, {{ end }}{{ $a }}{{ end }}){{ end }}.
            {{ with .Params.year }} ({{ . }}).{{ end }}
            {{ with .Params.journal }} <em>{{ . }}</em>,{{ end }}
            {{ with .Params.volume }} Vol. {{ . }},{{ end }}
            {{ with .Params.issue }} Issue {{ . }},{{ end }}
            {{ with .Params.pages }} pp. {{ . }}.{{ end }}
            {{ with .Params.doi }} DOI: <a href="{{ . }}" class="text-blue-600 font-bold hover:underline">{{ . }}</a>{{ end }}
          {{ end }}
          {{ with .Params.links }}
            <span class="space-x-2">
              {{ range . }}
                {{ if .name }}
                  <a href="{{ .url }}" target="_blank" class="text-blue-600 font-bold hover:underline">{{ .name }}</a>
                {{ end }}
              {{ end }}
            </span>
          {{ end }}
        </li>
      {{ end }}
    </ol>

    <!-- Education papers: enumerated -->
    <h2 class="text-3xl font-bold mb-6 text-[#18453B]">Education</h2>
    <ol class="list-decimal list-inside space-y-2 mb-12">
      {{ $edu := where site.RegularPages "Section" "education" }}
      {{ range $edu }}
        <li class="text-gray-800">
          {{ if .Params.citation }}
            {{ .Params.citation }}
          {{ else }}
            <strong>{{ .Title }}</strong>
            {{ with .Params.authors }}({{ range $i, $a := . }}{{ if $i }}, {{ end }}{{ $a }}{{ end }}){{ end }}.
            {{ with .Params.year }} ({{ . }}).{{ end }}
            {{ with .Params.journal }} <em>{{ . }}</em>,{{ end }}
            {{ with .Params.volume }} Vol. {{ . }},{{ end }}
            {{ with .Params.issue }} Issue {{ . }},{{ end }}
            {{ with .Params.pages }} pp. {{ . }}.{{ end }}
            {{ with .Params.doi }} DOI: <a href="{{ . }}" class="text-blue-600 font-bold hover:underline">{{ . }}</a>{{ end }}
          {{ end }}
          {{ with .Params.links }}
            <span class="space-x-2">
              {{ range . }}
                {{ if .name }}
                  <a href="{{ .url }}" target="_blank" class="text-blue-600 font-bold hover:underline">{{ .name }}</a>
                {{ end }}
              {{ end }}
            </span>
          {{ end }}
        </li>
      {{ end }}
    </ol>

    <!-- Guest Talks Section: collapsible per talk -->
    <h2 class="text-3xl font-bold mb-6 text-[#18453B]">Guest Talks</h2>
    <div class="space-y-4">
      {{ $talks := where site.RegularPages "Section" "guesttalks" }}
      {{ range $talks }}
        <div class="border-l-4 border-[#18453B] pl-4 pb-2" x-data="{ open: false }">
          
          <!-- Talk title: clickable -->
          <button class="w-full text-left text-xl md:text-2xl font-semibold text-[#18453B]" @click="open = !open">
            {{ .Title }}
            <span x-text="open ? '▼' : '▶'" class="ml-2"></span>
          </button>

          <!-- Collapsible content -->
          <div x-show="open" x-transition class="mt-2 pl-4">
            
            <!-- Date and event -->
            {{ with .Params.date }}<div class="text-gray-700">Date: {{ . }}</div>{{ end }}
            {{ with .Params.event }}<div class="text-gray-700">Event: {{ . }}</div>{{ end }}

            <!-- Links -->
            {{ with .Params.links }}
              <div class="mt-2 space-x-2">
                {{ range . }}
                  {{ if .name }}
                    <a href="{{ .url }}" target="_blank" class="text-blue-600 font-bold hover:underline">{{ .name }}</a>
                  {{ end }}
                {{ end }}
              </div>
            {{ end }}

            <!-- Optional image -->
            {{ with .Params.image }}
              <div class="mt-2">
                <img src="{{ . }}" alt="{{ .Title }}" class="w-full max-w-md rounded-lg shadow-md">
              </div>
            {{ end }}

            <!-- Optional description -->
            {{ with .Params.summary }}
              <p class="mt-2 text-gray-800">{{ . }}</p>
            {{ end }}

          </div>
        </div>
      {{ end }}
    </div>

  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
{{ end }}

























